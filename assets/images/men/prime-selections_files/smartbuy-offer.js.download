const getPreviousCartAttributes=async()=>{let cartAttributes={};try{let cartResponse=await fetch("/cart.js");if(!cartResponse.ok)throw new Error("Error in Response");let cartData=await cartResponse.json();const finalToken=cartData.token,firstPartLength=Math.min(finalToken.length,7),lastPartLength=Math.min(finalToken.length,8),cartToken=finalToken.slice(0,firstPartLength)+finalToken.slice(-lastPartLength),utm=localStorage.getItem("utm"),utm_medium=localStorage.getItem("utm_medium"),utm_campaign=localStorage.getItem("utm_campaign"),utm_direct=localStorage.getItem("utm_direct"),utm_medium_direct=localStorage.getItem("utm_medium_direct"),utm_campaign_direct=localStorage.getItem("utm_campaign_direct");cartAttributes={...cartData.attributes,cart_token:cartToken,utm_source:utm||"",utm_medium:utm_medium||"",utm_campaign:utm_campaign||"",utm_source_direct:utm_direct||"",utm_medium_direct:utm_medium_direct||"",utm_campaign_direct:utm_campaign_direct||""}}catch(error){console.error(error)}return cartAttributes},updateCartSmartbuyAttribute=async()=>{try{let previousCartAttributes=await getPreviousCartAttributes(),myHeaders=new Headers;myHeaders.append("Content-Type","application/json");let raw=JSON.stringify({attributes:{...previousCartAttributes,giftcard:"",paymentLockingPayload:JSON.stringify({mergeWithDefaultMethods:!1,action:"lock",paymentMethods:[{filterType:"whitelist",cardType:"DEBIT",cardIssuer:["HDFC Bank"],specificCardFilters:[{card_brand:null,card_type:null,card_bank:"HDFC Bank"}],paymentMethodType:"CARD"},{filterType:"whitelist",paymentMethod:["PAYZAPP"],paymentMethodType:"WALLET"}],supportReordering:!0}),gatewayReferenceId:"ccavenue"}});fetch("/cart/update.js",{method:"POST",headers:myHeaders,body:raw,redirect:"follow"}).then(response=>response.json()).then(result=>{const expiryDateString=getCookieVal("utmsource_smartbuy").expires;return document.cookie=`smartbuyUpdatedOnce=true|expires=${expiryDateString}; expires=${expiryDateString}; path=/`,!0}).catch(error=>console.error("error",error))}catch(error){console.error(error)}},updatePaymentGatewayAttribute=async()=>{try{let previousCartAttributes=await getPreviousCartAttributes(),myHeaders=new Headers;myHeaders.append("Content-Type","application/json");let raw=JSON.stringify({attributes:{...previousCartAttributes,paymentLockingPayload:"",gatewayReferenceId:"razorpay"}});fetch("/cart/update.js",{method:"POST",headers:myHeaders,body:raw,redirect:"follow"}).then(response=>response.json()).then(result=>!0).catch(error=>console.error("error",error))}catch(error){console.error(error)}};async function removeSmartBuyAttribute(){let previousCartAttributes=await getPreviousCartAttributes(),myHeaders=new Headers;myHeaders.append("Content-Type","application/json");let raw=JSON.stringify({attributes:{...previousCartAttributes,paymentLockingPayload:"",gatewayReferenceId:"razorpay"}});fetch("/cart/update.js",{method:"POST",headers:myHeaders,body:raw,redirect:"follow"}).then(response=>response.json()).then(result=>{}).catch(error=>console.error("error",error))}const clearSmartbuyCookieVariable=()=>{deleteCookie("utmsource_smartbuy"),deleteCookie("smartbuyUpdatedOnce")};async function enableSmartbuyOnItems(){try{let cartItemsPresent=document.querySelector("#CartDrawer-Form .custom-cart-item");if(cartItemsPresent){let giftVoucherInput=document.querySelector("#CartDrawer-Form .cart__gift-voucher");giftVoucherInput&&(giftVoucherInput.style.display="none")}getCookieVal("smartbuyUpdatedOnce")==null&&cartItemsPresent&&document.cookie.split(";").filter(item=>item.includes("cart=")).length!=0&&updateCartSmartbuyAttribute()&&document.querySelector("#CartDrawer .drawer__inner").getAttribute("data-iscustomer").trim()=="true"&&document.querySelectorAll(".gft-card")&&(document.querySelector(".custom-cartdrawer-overlay").classList.remove("hidden"),refundAllCards(),checkIfDiscountExists())}catch(error){console.error(error)}}
//# sourceMappingURL=/cdn/shop/t/353/assets/smartbuy-offer.js.map?v=165943953909136892351727354987
