cartSelectCounter=0,selectCartItemsArr=[];function updateCart(){fetch(`${routes.cart_url}?section_id=cart-drawer`).then(response=>response.text()).then(responseText=>{const html=new DOMParser().parseFromString(responseText,"text/html");cartSelectCounter=0,getCookieVal("utmsource_smartbuy")!=null&&html.documentElement.querySelector(".cart__gift-voucher")&&(html.documentElement.querySelector(".cart__gift-voucher").style.display="none"),document.querySelector("cart-drawer").innerHTML="",document.querySelector("cart-drawer").append(html.documentElement.querySelector("#CartDrawer"));const allItems=document.querySelectorAll(".cart-item");let sum=0;cartTotal=parseInt(document.querySelector("[data-totalprice]").getAttribute("data-totalprice")),allItems.length>0?(allItems.forEach(item=>{let itemCount=Number(item.querySelector(".custom-select-selected").getAttribute("value"));sum+=itemCount}),document.querySelector(".cart-count-bubble .cart-item__count").innerText=sum,document.querySelector("#CartDrawer-Form").style.display="block",document.querySelector(".drawer__header").style.display="flex",document.querySelector(".drawer__header").style.width="100%",document.querySelector(".cart__ctas").style.transform="translate(0%)"):document.querySelector("#CartDrawer-Form").style.display="none"})}function closeAllSelect(elmnt){for(var selects=document.getElementsByClassName("custom-select"),i=0;i<selects.length;i++)var select=selects[i],items=select.getElementsByClassName("select-items"),selected=select.getElementsByClassName("select-selected")}function deleteItem(event2){let dataId=event2.getAttribute("data-delete-variant-id");event2.parentElement.querySelector(".loading-overlay").classList.remove("hidden"),event2.parentElement.parentElement.parentElement.querySelector(".custom-cart-item__quantity").querySelector(".removeBtnCart").click(),typeof updateDeletedVariants=="function"&&updateDeletedVariants(dataId);let allDelete=document.querySelectorAll(".custom-delete-cart");allDelete&&allDelete.forEach(deleteBtn=>{deleteBtn.style.pointerEvents="none"}),fetchCardDetails(),screen.width>768&&setTimeout(()=>{showCartRecommendations()},"2000"),cartSelectCounter=0,selectCartItemsArr.length=0}function selectItems(event2){let targetTd=event2.closest(".custom-cart-item__media").parentElement.querySelector(".custom-cart-item__quantity"),plus=targetTd.querySelector("button[name='plus']"),minus=targetTd.querySelector("button[name='minus']"),qty=targetTd.querySelector("input"),selectedOption=event2.innerHTML,select=event2.parentElement.previousElementSibling;if(select.innerHTML=`${selectedOption} <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none">
<g id="np_right_5203532_000000 2">
<g id="Group">
<path id="Vector" d="M8.04118 11.4902C7.74528 11.1836 7.75015 10.6963 8.05094 10.3945C8.35269 10.0938 8.83999 10.0889 9.14664 10.3848L12.5001 13.7393L15.8536 10.3858L15.8536 10.3848C15.9991 10.2344 16.1993 10.1485 16.4093 10.1465C16.6183 10.1446 16.8204 10.2276 16.9689 10.375C17.1164 10.5235 17.1994 10.7256 17.1974 10.9346C17.1955 11.1446 17.1095 11.3448 16.9591 11.4903L13.0529 15.3965C12.7472 15.7012 12.2531 15.7012 11.9474 15.3965L8.04118 11.4902Z" fill="black"/>
</g>
</g>
</svg>`,qty.value>selectedOption){let diff=qty.value-selectedOption;for(let i=0;i<diff;i++)minus.click()}else if(qty.value<selectedOption){let diff=selectedOption-qty.value;for(let i=0;i<diff;i++)plus.click()}select.classList.add("selected"),closeAllSelect(this)}function cartCustomQtyFunction(event2){document.querySelectorAll(".custom-select").forEach(item=>{item!==event2&&item.classList.remove("addDisplay")}),closeAllSelect(this),event2.classList.toggle("addDisplay")}function closeAllCustomCartQty(){document.querySelectorAll(".custom-select").forEach(select=>{select.classList.contains("addDisplay")&&select.classList.remove("addDisplay")})}function custom_CartVariantFunction(event2){event2.querySelector(".custom_VariantSelect").classList.toggle("show_Variants")}function closeAll_CustomCartVariant(){document.querySelectorAll(".custom_VariantSelect").forEach(e=>{e.classList.remove("show_Variants")})}async function updateCartVariant(cartVariant_Id,cartVariant_Quantity,cartVariant_OptionId,cartVariant_OptionQtyAvailable,event2){let allCartVariantsArray=[],clickedVariantId=Number(event2.getAttribute("cartvariant_optionid")),isVariantAvailable;if(document.querySelectorAll("[data-SelectedVariantId]").forEach(e=>{allCartVariantsArray.push(Number(e.getAttribute("data-SelectedVariantId")))}),allCartVariantsArray.forEach(e=>{e==clickedVariantId&&(isVariantAvailable=!0)}),isVariantAvailable==!0)event2.closest(".custom-cart-item__media-div2").querySelector(".variantsAvailableText").style.display="inline-flex",setTimeout(()=>{event2.closest(".custom-cart-item__media-div2").querySelector(".variantsAvailableText").style.display="none"},5e3);else{event2.closest(".custom-cart-size-qty").querySelector("cart-drawer-items .loading-overlay").classList.remove("hidden"),await deleteCartVariant(cartVariant_Id),await addCartVariant(cartVariant_Quantity,cartVariant_OptionId,cartVariant_OptionQtyAvailable,event2),await updatePackCart(),event2.closest(".custom-cart-size-qty").querySelector("cart-drawer-items .loading-overlay").classList.add("hidden"),screen.width>768&&setTimeout(()=>{showCartRecommendations()},2e3),cartTemplate=document.querySelector("[cartTemplate]").getAttribute("cartTemplate"),cartTemplate=="product"&&variantsArr.forEach(z=>{if(z.id==cartVariant_Id&&(z.cartQty="0"),z.id==cartVariant_OptionId){let productVarUpdateQty;cartVariant_OptionQtyAvailable>=cartVariant_Quantity?(productVarUpdateQty=cartVariant_Quantity,z.cartQty=productVarUpdateQty.toString()):(productVarUpdateQty=cartVariant_OptionQtyAvailable,z.cartQty=productVarUpdateQty.toString())}});let checkedVariantLabel=document.querySelector(".variant_innerWrapper input[type=radio]:checked+label");checkedVariantLabel&&checkedVariantLabel.click()}}async function deleteCartVariant(cartVariant_Id){let variantBody={updates:{[cartVariant_Id]:0}},requestOptions={method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(variantBody)};try{return await(await fetch("/cart/update.js",requestOptions)).json}catch(err){throw err}}async function addCartVariant(cartVariant_Quantity,cartVariant_OptionId,cartVariant_OptionQtyAvailable,event2){let variantQuantity;cartVariant_OptionQtyAvailable>=cartVariant_Quantity?variantQuantity=cartVariant_Quantity:(variantQuantity=cartVariant_OptionQtyAvailable,event2.closest(".custom-cart-item__media-div2").querySelector(".variantsAvailableText").innerText=`Only ${variantQuantity} available `,event2.closest(".custom-cart-item__media-div2").querySelector(".variantsAvailableText").style.display="inline-block",setTimeout(()=>{event2.closest(".custom-cart-item__media-div2").querySelector(".variantsAvailableText").style.display="none"},3e3));let requestOptions={method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({items:[{id:cartVariant_OptionId,quantity:variantQuantity}]})};try{return await(await fetch("/cart/add.js",requestOptions)).json}catch(err){throw err}}async function addCartPack(packProdId,packProdQuant,packProdPrice,mainProdId,addBtn){const cartClose=document.querySelector(".custom-drawer__close");let totalCartAmount=parseInt(document.querySelector("[data-totalprice]").getAttribute("data-totalprice"))+parseInt(packProdPrice);event.preventDefault();const loadingOverlay=document.querySelector(`.cart-pack-loading-overlay[data-variant-id="${packProdId}"]`);if(loadingOverlay.classList.remove("hidden"),totalCartAmount<=49999)try{let response=await fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:packProdId,quantity:packProdQuant}]})});response.ok||console.error("Failed to add product pack to cart");let data=await response.json();const updateData={updates:{[mainProdId]:0}};response=await fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(updateData)}),response.ok||console.error("Failed to remove main product from cart"),data=await response.json(),screen.width>768&&setTimeout(()=>{showCartRecommendations()},2e3),updatePackCart(addBtn),updateDeletedVariants(mainProdId),productMsg()}catch(error){console.error("Error updating the cart:",error)}else loadingOverlay.classList.add("hidden"),orderValueExceededMsg(),closeAllCustomCartQty(),closeCartRecommendations(),document.querySelector("cart-drawer")?.close()}function updatePackCart(addBtn){fetch(`${routes.cart_url}?section_id=cart-drawer`).then(data=>data.text()).then(result=>{var parser=new DOMParser,htmlString=`${result}`,doc3=parser.parseFromString(htmlString,"text/html");getCookieVal("utmsource_smartbuy")!=null&&doc3.documentElement.querySelector(".cart__gift-voucher")&&(doc3.documentElement.querySelector(".cart__gift-voucher").style.display="none"),document.querySelector("cart-drawer").innerHTML="",document.querySelector("cart-drawer").append(doc3.documentElement.querySelector("#CartDrawer"));var cartProductItem=document.querySelectorAll(".cart-item"),sum=0;document.querySelectorAll(".cart-items").length>0?(cartProductItem.forEach(function(cartItem){var selectSelectedElements=cartItem.querySelectorAll(".custom-select-selected");selectSelectedElements.forEach(function(selectSelected){var value=parseInt(selectSelected.getAttribute("value"));!isNaN(value)&&value>0&&(sum+=value)})}),document.querySelector(".cart-count-bubble .cart-item__count").innerText=sum,document.querySelector("#CartDrawer-Form").style.display="block",document.querySelector(".drawer__header").style.display="flex",document.querySelector(".drawer__header").style.width="100%",document.querySelector(".cart__ctas").style.transform="translate(0%)"):(document.querySelector("#CartDrawer-Form").style.display="none",document.querySelector(".cart-count-bubble .cart-item__count").innerText=0)}),fetchCart(),cartSelectCounter=0}if(screen.width>768)var closeCartRecommendations=function(){const cartDrawerRecommendation=document.querySelector(".cart-drawer--recommendations--container");cartDrawerRecommendation.style.transform="translate(0)"};function showCartRecommendations(){if(document.querySelector(".custom-cart-tableBody")){const cartDrawerRecommendation=document.querySelector(".cart-drawer--recommendations--container");cartDrawerRecommendation.style.transform="translate(-95%)"}else{const cartDrawerRecommendation=document.querySelector(".cart-drawer--recommendations--container");cartDrawerRecommendation&&(cartDrawerRecommendation.style.transform="translate(0)")}}screen.width>768&&document.querySelector(".custom-cart__icon").addEventListener("click",showCartRecommendations);function cartIconSelect(event2){let iconSelect=document.querySelector(".selectIcon_Heading  .icon-select-span"),iconSelect_Active=document.querySelector(".selectIcon_Heading  .icon-select-active-span"),iconSelectAll_Active=document.querySelector(".selectIcon_Heading  .icon-selectAll-active-span");var cartItemCount=parseInt(document.querySelector("[data-cartItemCount]").getAttribute("data-cartItemCount"));let selectedItemVariantId=event2.closest("data-selectId");if(event2.classList.contains("selected")){event2.classList.remove("selected"),event2.closest(".cart-item.custom-cart-item").classList.remove("selected"),cartSelectCounter--,cartSelectCounter==0?(document.querySelector(".itemSelect_CountSpan").classList.add("hidden"),event2.closest(".drawer__cart-items-wrapper").querySelector(".select_CartItems").classList.remove("active"),iconSelect.style.display="block",iconSelectAll_Active.style.display="none",iconSelect_Active.style.display="none"):(event2.closest(".drawer__cart-items-wrapper").querySelector(".select_CartItems").classList.add("active"),cartItemCount>cartSelectCounter?(iconSelect_Active.style.display="block",iconSelectAll_Active.style.display="none"):(iconSelect_Active.style.display="none",iconSelectAll_Active.style.display="block"),document.querySelector(".itemSelect_CountSpan").classList.remove("hidden"));let selectItemVariantId=event2.closest(".custom-cart-item").getAttribute("cart-variant-id");selectCartItemsArr=selectCartItemsArr.filter(num=>num!=selectItemVariantId)}else{event2.classList.add("selected"),event2.closest(".drawer__cart-items-wrapper").querySelector(".select_CartItems").classList.add("active"),event2.closest(".cart-item.custom-cart-item").classList.add("selected"),cartSelectCounter++,document.querySelector(".itemSelect_CountSpan").classList.remove("hidden"),cartItemCount>cartSelectCounter?(iconSelect.style.display="none",iconSelect_Active.style.display="block"):(iconSelect.style.display="none",iconSelect_Active.style.display="none",iconSelectAll_Active.style.display="block");let selectedItemVariantId2=event2.closest(".custom-cart-item").getAttribute("cart-variant-id");selectCartItemsArr.push(selectedItemVariantId2)}document.querySelector(".itemSelect_Count").innerHTML=cartSelectCounter}function selectAll_Items(event2){let iconSelect=document.querySelector(".selectIcon_Heading  .icon-select-span"),iconSelect_Active=document.querySelector(".selectIcon_Heading  .icon-select-active-span"),iconSelectAll_Active=document.querySelector(".selectIcon_Heading  .icon-selectAll-active-span"),cartItemCount=parseInt(document.querySelector("[data-cartItemCount]").getAttribute("data-cartItemCount"));event2.closest(".select_CartItems").classList.add("active"),iconSelect.style.display="none",iconSelect_Active.style.display="none",iconSelectAll_Active.style.display="block",cartSelectCounter=cartItemCount,document.querySelector(".itemSelect_Count").innerHTML=cartItemCount,document.querySelector(".itemSelect_CountSpan").classList.remove("hidden"),document.querySelectorAll(".cart-item.custom-cart-item").forEach(e=>{e.classList.add("selected")}),document.querySelectorAll(".cartItem_SelectIcon").forEach(e=>{e.classList.add("selected")}),document.querySelectorAll("[cart-variant-id]").forEach(e=>{selectCartItemsArr.push(e.getAttribute("cart-variant-id"))})}function deSelectAll_CartItems(event2){let iconSelect=document.querySelector(".selectIcon_Heading  .icon-select-span"),iconSelect_Active=document.querySelector(".selectIcon_Heading  .icon-select-active-span"),iconSelectAll_Active=document.querySelector(".selectIcon_Heading  .icon-selectAll-active-span"),cartItemCount=parseInt(document.querySelector("[data-cartItemCount]").getAttribute("data-cartItemCount"));event2.closest(".select_CartItems").classList.remove("active"),iconSelect.style.display="block",iconSelect_Active.style.display="none",iconSelectAll_Active.style.display="none",cartSelectCounter=0,document.querySelector(".itemSelect_CountSpan").classList.add("hidden"),document.querySelectorAll(".cart-item.custom-cart-item").forEach(e=>{e.classList.remove("selected")}),document.querySelectorAll(".cartItem_SelectIcon").forEach(e=>{e.classList.remove("selected")}),selectCartItemsArr.length=0}function delCartItems_Modal(){screen.width<769&&document.querySelector("cart-drawer.drawer.active")?(document.querySelector(".overlayDiv").style.display="block",document.querySelector(".wishlistDelete_MobModal").style.transform="translateY(0vh)",document.querySelector(".cartDeleteCount").innerHTML=cartSelectCounter):(document.querySelector(".overlayDiv_Desk").style.display="block",document.querySelector("cart-drawer").classList.remove("active"),!document.querySelector("cart-drawer.drawer.active")&&screen.width<420&&(document.querySelector(".wishlistDelete_DeskModal").style.width="90%"),document.querySelector(".wishlistDelete_DeskModal").style.display="grid",document.querySelector(".cartDeleteCountD").innerHTML=cartSelectCounter)}function wishlistCartItems_Modal(event2){screen.width<769?(document.querySelector(".overlayDiv").style.display="block",document.querySelector(".wishlistDelete_MobModal").style.transform="translateY(0vh)",document.querySelector(".wishlistDelete_MobModal").classList.add("wishlistMobModal"),document.querySelector(".cartWishlistCount").innerHTML=cartSelectCounter):(document.querySelector("cart-drawer").classList.remove("active"),document.querySelector(".wishlistDelete_DeskModal").classList.add("wishlistDeskModal"),document.querySelector(".overlayDiv_Desk").style.display="block",document.querySelector(".wishlistDelete_DeskModal").style.display="grid",document.querySelector(".cartWishlistCountD").innerHTML=cartSelectCounter)}function closeSelected_CartItems(){screen.width>769&&document.querySelector("body").classList.remove("overflow-hidden"),screen.width<769&&document.querySelector("cart-drawer.drawer.active")?(document.querySelector(".wishlistDelete_MobModal").style.transform="translateY(80vh)",document.querySelector(".overlayDiv").style.display="none",setTimeout(()=>{document.querySelector(".wishlistDelete_MobModal").classList.remove("wishlistMobModal")},300)):(document.querySelector(".overlayDiv_Desk").style.animation="opacityFade 0.5s forwards",document.querySelector(".wishlistDelete_DeskModal").style.animation="opacityFade 0.5s forwards",setTimeout(()=>{document.querySelector(".overlayDiv_Desk").style.display="none",document.querySelector(".wishlistDelete_DeskModal").style.display="none",document.querySelector(".overlayDiv_Desk").style.animation="opacityTrans 0.5s forwards",document.querySelector(".wishlistDelete_DeskModal").style.animation="opacityTrans 0.5s forwards",document.querySelector(".wishlistDelete_DeskModal").classList.remove("wishlistDeskModal")},500)),document.querySelectorAll(".cartItem_SelectIcon.selectedDelete").length!=0&&(document.querySelectorAll(".cartItem_SelectIcon.selectedDelete").forEach(e=>{e.classList.remove("selectedDelete")}),selectCartItemsArr.length=0,cartSelectCounter=0)}let deleteArr=[];async function removeCartItems(event2){event2.classList.contains("removeItemsCartD")?document.querySelector(".removeItemsCartD .loading-overlay__spinner").classList.remove("hidden"):event2.classList.contains("removeItemsCart")&&document.querySelector(".removeItemsCart .loading-overlay__spinner").classList.remove("hidden"),deleteArr=selectCartItemsArr.reduce((obj,itemId)=>(obj[itemId]=0,obj),{}),await deleteSelectArr(deleteArr),await updatePackCart(),(event2.classList.contains("removeItemsCartD")||event2.classList.contains("removeItemsCart"))&&document.querySelector(".removeItemsCartD .loading-overlay__spinner").classList.add("hidden"),parseInt(document.querySelector("[data-cartItemCount]")?.getAttribute("data-cartitemcount"))==selectCartItemsArr.length&&document.querySelector("cart-drawer").classList.add("is-empty"),document.querySelector(".close_WishlistDelete_ModalD").click(),cartTemplate=document.querySelector("[cartTemplate]").getAttribute("cartTemplate"),cartTemplate=="product"&&variantsArr.forEach(e=>{selectCartItemsArr.forEach(y=>{e.id==y&&(e.cartQty="0")})}),selectCartItemsArr.length=0,deleteArr=[];let checkedVariantLabel=document.querySelector(".variant_innerWrapper input[type=radio]:checked+label");return checkedVariantLabel&&checkedVariantLabel.click(),"Item(s) Deleted"}async function deleteSelectArr(deleteArr2){let requestOptions1={method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({updates:deleteArr2})};try{let responseJSON=await(await fetch("/cart/update.js",requestOptions1)).json();return typeof updateDeletedVariants=="function"&&updateDeletedVariants(deleteArr2),"done"}catch(err){throw document.querySelector(".removeItemsCartD .loading-overlay__spinner").classList.add("hidden"),err}}async function moveToWishlist(event2){event2.classList.contains("moveToWishlistD")?document.querySelector(".moveToWishlistD .loading-overlay__spinner").classList.remove("hidden"):document.querySelector(".moveToWishlist .loading-overlay__spinner").classList.remove("hidden"),document.querySelectorAll(".cartItem_SelectIcon.selected").forEach(e=>{e.parentElement.nextElementSibling.querySelector(".addToWishlist").click()}),document.querySelectorAll(".cartItem_SelectIcon.selectedDelete").forEach(e=>{e.parentElement.nextElementSibling.querySelector(".addToWishlist").click()}),await removeCartItems(event2),event2.classList.contains("moveToWishlistD")?document.querySelector(".moveToWishlistD .loading-overlay__spinner").classList.add("hidden"):document.querySelector(".moveToWishlist .loading-overlay__spinner").classList.add("hidden"),document.querySelector("[cartTemplate]").getAttribute("cartTemplate")=="account"&&(screen.width>767?wishlist():wishlistM())}function overlayCloseModal(event2){event2.classList.contains("wishlistDelete_DeskModal")||event2.classList.contains("wishlistDelete_MobModal")||closeSelected_CartItems()}let wishlistModalTouchStartPosition;wishlistBarClose();function wishlistBarClose(){document.querySelector('[wishlist-barclose="wishlistModalclose"]').addEventListener("touchstart",wishlistModalBartoCloseTouchStartHandler,{passive:!0}),document.querySelector('[wishlist-barclose="wishlistModalclose"]').addEventListener("touchend",wishlistModalBartoCloseTouchEndHandler,{passive:!0}),document.querySelector('[wishlist-barclose="wishlistModalclose"]').addEventListener("touchmove",wishlistModalBartoCloseTouchMoveHandler,{passive:!0})}function wishlistModalBartoCloseTouchStartHandler(event2){wishlistModalTouchStartPosition=event2.touches[0].clientY}function wishlistModalBartoCloseTouchMoveHandler(event2){wishlistModalTouchStartPosition!==void 0&&event2.touches[0].clientY-wishlistModalTouchStartPosition>60&&closeSelected_CartItems()}function wishlistModalBartoCloseTouchEndHandler(event2){wishlistModalTouchStartPosition=void 0}function delete_wishlist_item(event2){document.querySelector(".icon-selectAll-active-span").click(),selectCartItemsArr.length=0,selectCartItemsArr.push(event2.getAttribute("data-delete-variant-id")),event2.parentElement.previousElementSibling.querySelector(".cartItem_SelectIcon").classList.add("selectedDelete"),cartSelectCounter=1,delCartItems_Modal()}
//# sourceMappingURL=/cdn/shop/t/353/assets/custom-cart-drawer.js.map?v=6992861714617650031740637501
